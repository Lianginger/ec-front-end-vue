(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a27d422"],{2919:function(t,e,s){},"9b2a":function(t,e,s){"use strict";var a=s("2fa3");e["a"]={postOrder:function(t){return a["apiHelper"].post("/order",t)},getOrder:function(){return a["apiHelper"].get("/order")}}},"9e48":function(t,e,s){"use strict";var a=s("2919"),r=s.n(a);r.a},aaff:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container py-5"},[t._m(0),t.cartItems.length<1?s("div",{staticClass:"row mt-5"},[s("div",{staticClass:"col-md-6 col-12 mx-auto"},[s("i",{staticClass:"fa fa-shopping-cart fa-5",attrs:{"aria-hidden":"true"}}),s("div",{staticClass:"mt-3 text-center"},[s("h5",[t._v("你的購物車是空的")]),s("p",[t._v("記得加入商品到你的購物車")]),s("router-link",{staticClass:"btn btn-success btn-large",attrs:{to:"/products"}},[t._v("繼續購物")])],1)])]):s("div",{staticClass:"row mt-3"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"card",attrs:{"data-toggle":"collapse",href:"#cartSummary","aria-expanded":"true"}},[s("div",{staticClass:"card-header py-3 text-center border"},[s("h4",[t._v("合計: NT "+t._s(t._f("currency")(t.total_amount+t.shipping_fee-t.coupon_discount_fee)))]),s("h5",[t._v("\n            購物車 (\n            "),s("span",{staticClass:"sl-cart-count ng-isolate-scope"},[t._v(t._s(t.cartItems.length))]),t._v(" 件)\n            "),t.status?t._e():s("i",{staticClass:"fa fa-angle-down",attrs:{"aria-hidden":"true"},on:{click:t.collapseStatusChange}}),t.status?s("i",{staticClass:"fa fa-angle-up",attrs:{"aria-hidden":"true"},on:{click:t.collapseStatusChange}}):t._e()])]),s("div",{staticClass:"collapse",attrs:{id:"cartSummary"}},[s("div",{staticClass:"card-body border"},[t._m(1),s("hr",{staticClass:"hidden-In-Mobile"}),t._l(t.cartItems,function(e){return s("div",{key:e.id,staticClass:"table-row row cart-item py-1"},[s("div",{staticClass:"col-7 col-sm-4 item-information"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 px-0"},[s("router-link",{attrs:{to:{name:"product",params:{productId:e.id}}}},[s("img",{staticClass:"col-auto",attrs:{src:t._f("emptyImage")(e.image),alt:""}})])],1),s("div",{staticClass:"col-6 pl-0 my-auto"},[s("div",[t._v(t._s(e.name))])])])]),s("div",{staticClass:"col-1 col-sm-1 item-promotion"}),s("div",{staticClass:"col-4 col-sm-2 text-center item-price my-auto"},[s("div",{staticClass:"row"},[s("span",{staticClass:"col-12 col-md-12 sell_price font-weight-bold"},[t._v("NT "+t._s(t._f("currency")(e.sell_price)))]),s("span",{staticClass:"col-12 col-md-12 original-price text-muted font-italic"},[t._v("NT "+t._s(t._f("currency")(e.origin_price)))])])]),s("div",{staticClass:"col-6 col-md-2 text-center item-quantity my-auto"},[s("div",[t._v(t._s(e.CartItem.quantity))])]),s("div",{staticClass:"col-6 col-md-3 text-center item-total my-auto"},[s("span",{staticClass:"total-count"},[t._v("NT "+t._s(t._f("currency")(e.sell_price*e.CartItem.quantity)))])])])})],2),s("div",{staticClass:"card-body cart-promotions border d-none"},[s("div",{staticClass:"row"},[s("h5",{staticClass:"col-12"},[t._v("已享用之優惠")]),s("div",{staticClass:"col-12 promotion-coupon"},[s("div",{staticClass:"row text-center p-3"},[s("span",{staticClass:"col-4 col-md-2 ccoupon-name bg-success text-light my-auto py-2"},[t._v(t._s(t.couponData.name))]),s("span",{staticClass:"col-4 col-md-3 my-auto py-2 coupon-description"},[t._v(t._s(t.couponData.description))]),s("span",{staticClass:"col-4 col-md-7 my-auto py-2 text-right discount"},[s("div",{staticClass:"row"},[s("span",{staticClass:"col-12"},[t._v("- NT "+t._s(t._f("currency")(t.coupon_discount_fee)))])])])])])])]),s("div",{staticClass:"card-body border"},[s("div",{staticClass:"row text-right"},[s("div",{staticClass:"col-12 subtotal"},[s("div",{staticClass:"col-8 col-md-9 d-inline-block"},[t._v("小計:")]),s("div",{staticClass:"col-4 col-md-3 d-inline-block"},[t._v("NT "+t._s(t._f("currency")(t.total_amount)))])]),s("div",{staticClass:"col-12 delivery-fee"},[s("div",{staticClass:"col-8 col-md-9 d-inline-block"},[t._v("運費:")]),s("div",{staticClass:"col-4 col-md-3 d-inline-block"},[t._v("NT "+t._s(t._f("currency")(t.shipping_fee)))])]),s("div",{staticClass:"col-12 coupon-fee"},[s("div",{staticClass:"col-8 col-md-9 d-inline-block"},[t._v("折扣:")]),s("div",{staticClass:"col-4 col-md-3 d-inline-block"},[t._v("- NT "+t._s(t._f("currency")(t.coupon_discount_fee)))])]),s("div",{staticClass:"col-12 total"},[s("div",{staticClass:"col-8 col-md-9 d-inline-block"},[t._v("合計:")]),s("div",{staticClass:"col-4 col-md-3 d-inline-block font-weight-bold"},[t._v("NT "+t._s(t._f("currency")(t.total_amount+t.shipping_fee-t.coupon_discount_fee)))])])])]),t._m(2)])])])]),s("form",{staticClass:"row mt-3",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.postOrder(e)}}},[s("div",{staticClass:"col-sm-6"},[s("section",{staticClass:"customer-form"},[t._m(3),s("div",{staticClass:"section-body"},[s("div",{attrs:{name:"customerForm"}},[s("div",{staticClass:"form-group"},[t._m(4),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerName,expression:"customerName"}],staticClass:"form-control",attrs:{id:"order-customer-name",type:"text",name:"orderCustomerName",placeholder:"皮爾斯",required:""},domProps:{value:t.customerName},on:{input:function(e){e.target.composing||(t.customerName=e.target.value)}}})]),s("div",{staticClass:"form-group"},[t._m(5),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerEmail,expression:"customerEmail"}],staticClass:"form-control",attrs:{id:"order-customer-email",type:"email",name:"orderCustomerEmail",placeholder:"pp@gmail.com",required:""},domProps:{value:t.customerEmail},on:{input:function(e){e.target.composing||(t.customerEmail=e.target.value)}}})]),s("div",{staticClass:"form-group"},[t._m(6),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerPhone,expression:"customerPhone"}],staticClass:"form-control",attrs:{id:"order-customer-phone",type:"tel",name:"orderCustomerPhone",placeholder:"0912345678",required:""},domProps:{value:t.customerPhone},on:{input:function(e){e.target.composing||(t.customerPhone=e.target.value)}}})]),s("div",{staticClass:"form-group"},[t._m(7),s("input",{directives:[{name:"model",rawName:"v-model",value:t.customerAddress,expression:"customerAddress"}],staticClass:"form-control",attrs:{id:"order-customer-address",type:"address",name:"orderCustomerAddress",placeholder:"台北市中正區工程路66號",required:""},domProps:{value:t.customerAddress},on:{input:function(e){e.target.composing||(t.customerAddress=e.target.value)}}})])])])]),t._m(8)]),s("div",{staticClass:"col-sm-6"},[s("section",{staticClass:"delivery-form"},[s("div",{staticClass:"row section-header"},[s("span",{staticClass:"col-6 px-0"},[t._v("送貨資料")]),s("span",{staticClass:"col-6 px-0 text-right"},[t._v("運費: NT "+t._s(t.shipping_fee))])]),s("div",{staticClass:"section-body"},[s("p",[t._v("已選擇的送貨方式: "+t._s(t.shipping_method))]),s("div",{attrs:{id:"delivery-form-content"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"control-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.shippingFormStatus,expression:"shippingFormStatus"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.shippingFormStatus)?t._i(t.shippingFormStatus,null)>-1:t.shippingFormStatus},on:{change:[function(e){var s=t.shippingFormStatus,a=e.target,r=!!a.checked;if(Array.isArray(s)){var o=null,i=t._i(s,o);a.checked?i<0&&(t.shippingFormStatus=s.concat([o])):i>-1&&(t.shippingFormStatus=s.slice(0,i).concat(s.slice(i+1)))}else t.shippingFormStatus=r},t.automaticFillIn]}}),t._v(" 收件人資料與顧客資料相同\n              ")])]),s("div",{staticClass:"form-group"},[t._m(9),s("input",{directives:[{name:"model",rawName:"v-model",value:t.tempName,expression:"tempName"}],staticClass:"form-control",attrs:{id:"recipient-name",type:"text",name:"orderRecipientName",required:""},domProps:{value:t.tempName},on:{input:function(e){e.target.composing||(t.tempName=e.target.value)}}}),s("span",[t._v("請填入收件人真實姓名，以確保順利收件")])]),s("div",{staticClass:"form-group"},[t._m(10),s("input",{directives:[{name:"model",rawName:"v-model",value:t.tempPhone,expression:"tempPhone"}],staticClass:"form-control",attrs:{id:"recipient-phone",type:"tel",name:"orderRecipientPhone",required:""},domProps:{value:t.tempPhone},on:{input:function(e){e.target.composing||(t.tempPhone=e.target.value)}}})]),s("hr"),s("div",{staticClass:"form-group"},[t._m(11),s("input",{directives:[{name:"model",rawName:"v-model",value:t.tempAddress,expression:"tempAddress"}],staticClass:"form-control",attrs:{id:"recipient-address",type:"address",name:"orderRecipientAddress",required:""},domProps:{value:t.tempAddress},on:{input:function(e){e.target.composing||(t.tempAddress=e.target.value)}}})])])])]),s("section",{staticClass:"payment-form"},[t._m(12),s("div",{staticClass:"row section-body"},[t._m(13),s("div",{staticClass:"col-12 font-weight-bold"},[t._v("合計:  NT "+t._s(t._f("currency")(t.total_amount+t.shipping_fee-t.coupon_discount_fee)))])])])]),s("div",{staticClass:"col-12"},[s("div",{staticClass:"card mt-3"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"row py-2"},[s("div",{staticClass:"col-4 col-md-6"},[s("a",{staticClass:"btn btn-link",attrs:{href:"#"},on:{click:function(e){return t.$router.back()}}},[t._v("<返回購物車")])]),s("div",{staticClass:"col-8 col-md-6"},[s("button",{staticClass:"btn btn-success btn-block text-white",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(t._s(t.isProcessing?"處理中...":"買單去"))])])])])])])])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-content-center mt-3"},[s("div",{staticClass:"col-md-7 col-12"},[s("div",{staticClass:"row step"},[s("div",{staticClass:"col text-center step-point-line"},[s("span",{staticClass:"border bg-secondary px-4 py-2 rounded-pill text-dark mb-3 d-inline-block"},[t._v("Step 1")]),s("p",{staticClass:"text-dark h6"},[t._v("購物車")])]),s("div",{staticClass:"col text-center step-point-line step-point"},[s("span",{staticClass:"bg-dark px-4 py-2 rounded-pill text-light mb-3 d-inline-block"},[t._v("Step 2")]),s("p",{staticClass:"text-dark h6"},[t._v("填寫資料")])]),s("div",{staticClass:"col text-center"},[s("span",{staticClass:"border bg-secondary px-4 py-2 rounded-pill text-dark mb-3 d-inline-block"},[t._v("Step 3")]),s("p",{staticClass:"text-dark h6"},[t._v("訂單確認與付款")])])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row hidden-In-Mobile"},[s("div",{staticClass:"col-sm-4"},[t._v("商品資料")]),s("div",{staticClass:"col-sm-1"},[t._v("優惠")]),s("div",{staticClass:"col-sm-2 text-center"},[t._v("單件價格")]),s("div",{staticClass:"col-sm-2 text-center"},[t._v("數量")]),s("div",{staticClass:"col-sm-3 text-center item-total"},[t._v("小計")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card-footer text-center"},[s("i",{staticClass:"fa fa-angle-up",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row section-header"},[s("span",{staticClass:"col-12 px-0"},[t._v("顧客資料")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"order-customer-name"}},[t._v("\n                顧客名稱\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"order-customer-email"}},[t._v("\n                電子信箱\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"order-customer-phone"}},[t._v("\n                電話號碼\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"order-customer-address"}},[t._v("\n                地址\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"remark-form"},[s("div",{staticClass:"row section-header"},[s("span",{staticClass:"col-12 px-0"},[t._v("訂單備註")])]),s("div",{staticClass:"section-body"},[s("div",{attrs:{name:"remarksForm"}},[s("div",{staticClass:"form-group"},[s("textarea",{staticClass:"form-control",attrs:{id:"order-remarks",name:"orderRemark",placeholder:"有什麼想告訴賣家嗎？"}})])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"recipient-name"}},[t._v("\n                收件人名稱\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"recipient-phone"}},[t._v("\n                收件人電話號碼\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"control-label",attrs:{for:"recipient-address"}},[t._v("\n                收件人地址\n                "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row section-header"},[s("span",{staticClass:"col-12 px-0"},[t._v("付款資料")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-12",attrs:{name:"paymentForm"}},[s("div",{staticClass:"form-group"},[t._v("訂單支援的付款方式:")]),s("ul",[s("li",[t._v("信用卡一次付清")]),s("li",[t._v("ATM轉帳")]),s("li",[t._v("超商代碼繳費")])])])}],o=(s("96cf"),s("3b8d")),i=s("cc17"),c=s("9b2a"),n=s("ab31"),l=s("2708"),u=s("2fa3"),d={mixins:[l["a"],l["d"]],data:function(){return{cartId:0,cartItems:[],total_amount:0,shipping_fee:0,shipping_method:"",status:!1,shippingFormStatus:!1,customerName:"王大明",customerEmail:"root@gmail.com",customerPhone:"0912345678",customerAddress:"台北市大師區工程路996號",tempName:"",tempPhone:"",tempAddress:"",isProcessing:!1,couponData:{},coupon_discount_fee:0}},created:function(){this.fetchCart(),this.fetchCoupon()},methods:{fetchCart:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,s,a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=this,t.next=4,i["a"].getCart();case 4:if(s=t.sent,a=s.data,r=s.statusText,console.log("訂單創建頁面 購物車內容",a),"OK"===r){t.next=10;break}throw new Error(r);case 10:if(e.cartItems=a.cart.items,e.$store.commit("setNavbarCartItemNumber",e.cartItems.length),!(e.cartItems.length<1)){t.next=14;break}return t.abrupt("return");case 14:e.cartItems.map(function(t){return t.id*t.id}).reduce(function(t,e){return t+e}),e.total_amount=a.total_amount,e.shipping_method=a.cart.shipping_method,e.shipping_fee=a.cart.shipping_fee,t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](0),u["Toast"].fire({type:"error",title:"無法取得購物車資料，請稍後再試"});case 23:case"end":return t.stop()}},t,this,[[0,20]])}));function e(){return t.apply(this,arguments)}return e}(),postOrder:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var s,a,r,o,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,s=this,a=e.target,r=new FormData(a),s.isProcessing=!0,t.next=7,c["a"].postOrder(r);case 7:if(o=t.sent,i=o.data,n=o.statusText,"OK"===n&&"success"===i.status){t.next=12;break}throw new Error(n);case 12:s.isProcessing=!1,u["Toast"].fire({type:"success",title:"訂單已新增，請確認"}),s.$store.commit("setNavbarCartItemNumber",0),s.$router.push({name:"orderDetail"}),t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](0),this.isProcessing=!1,u["Toast"].fire({type:"error",title:"無法新增訂單，請稍後再試"});case 22:case"end":return t.stop()}},t,this,[[0,18]])}));function e(e){return t.apply(this,arguments)}return e}(),fetchCoupon:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,s,a,r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=this,t.next=4,n["a"].getCoupon();case 4:if(s=t.sent,a=s.data,r=s.statusText,"error"!==a.status){t.next=9;break}return t.abrupt("return");case 9:if("OK"===r){t.next=11;break}throw new Error(r);case 11:e.couponData=a.couponData,0===e.couponData.type&&1===e.couponData.shipping_free&&(e.coupon_discount_fee=e.shipping_fee,console.log("運費",e.coupon_discount_fee)),1===e.couponData.type&&null!==e.couponData.product_reduce&&(e.coupon_discount_fee=e.couponData.product_reduce,console.log("折價",e.coupon_discount_fee)),2===e.couponData.type&&null!==e.couponData.percent&&(o=1-e.couponData.percent/100,e.coupon_discount_fee=Math.round(e.total_amount*o),console.log("打折",e.coupon_discount_fee)),document.querySelector(".cart-promotions").classList.remove("d-none"),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](0),u["Toast"].fire({type:"error",title:"無法取得優惠券資料，請稍後再試"});case 21:case"end":return t.stop()}},t,this,[[0,18]])}));function e(){return t.apply(this,arguments)}return e}(),collapseStatusChange:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.status=!this.status;case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),automaticFillIn:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=this,e.shippingFormStatus?(e.tempName=e.customerName,e.tempPhone=e.customerPhone,e.tempAddress=e.customerAddress):(e.tempName="",e.tempPhone="",e.tempAddress="");case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},p=d,m=(s("9e48"),s("2877")),v=Object(m["a"])(p,a,r,!1,null,null,null);e["default"]=v.exports},ab31:function(t,e,s){"use strict";var a=s("2fa3");e["a"]={postCoupon:function(t){return a["apiHelper"].post("/coupon",t)},getCoupon:function(){return a["apiHelper"].get("/coupon")},deleteCoupon:function(t){return a["apiHelper"].delete("/coupon",t)}}}}]);
//# sourceMappingURL=chunk-6a27d422.db69d1d8.js.map